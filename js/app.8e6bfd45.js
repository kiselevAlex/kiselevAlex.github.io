(function(t){function e(e){for(var r,s,c=e[0],i=e[1],u=e[2],d=0,p=[];d<c.length;d++)s=c[d],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&p.push(o[s][0]),o[s]=0;for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r]);l&&l(e);while(p.length)p.shift()();return a.push.apply(a,u||[]),n()}function n(){for(var t,e=0;e<a.length;e++){for(var n=a[e],r=!0,c=1;c<n.length;c++){var i=n[c];0!==o[i]&&(r=!1)}r&&(a.splice(e--,1),t=s(s.s=n[0]))}return t}var r={},o={app:0},a=[];function s(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.m=t,s.c=r,s.d=function(t,e,n){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)s.d(n,r,function(e){return t[e]}.bind(null,r));return n},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],i=c.push.bind(c);c.push=e,c=c.slice();for(var u=0;u<c.length;u++)e(c[u]);var l=i;a.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"01b4":function(t,e,n){},"034f":function(t,e,n){"use strict";var r=n("85ec"),o=n.n(r);o.a},1573:function(t,e,n){"use strict";var r=n("01b4"),o=n.n(r);o.a},"1e36":function(t,e,n){"use strict";var r=n("e29d"),o=n.n(r);o.a},2110:function(t,e,n){t.exports=n.p+"img/basket.0d14a209.svg"},"2df3":function(t,e,n){"use strict";var r=n("2f3a"),o=n.n(r);o.a},"2f3a":function(t,e,n){},"4a51":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("2b0e"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[t.loading?n("div",[t._v("Загрузка...")]):n("Catalog",{attrs:{categoriesMap:t.categoriesMap,goodsMap:t.goodsMap,onBasket:t.updateBasket}}),n("Basket",{attrs:{items:t.basket,goodsMap:t.goodsMap,onBasket:t.updateBasket}})],1)},a=[],s=(n("d3b7"),n("3ca3"),n("ddb0"),n("5530")),c=(n("96cf"),n("1da1")),i=n("2f62"),u=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"categories"},t._l(t.categoriesMap,(function(e){return n("Category",{key:e.id,staticClass:"categories-item",attrs:{category:e},scopedSlots:t._u([{key:"default",fn:function(e){var r=e.goodIds;return t._l(r,(function(e){return n("Goods",{key:e,attrs:{goods:t.goodsMap[e],onBasket:t.onBasket}})}))}}],null,!0)})})),1)},l=[],d=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Card",{staticClass:"category",scopedSlots:t._u([{key:"title",fn:function(){return[t._v(t._s(t.category.name))]},proxy:!0},{key:"content",fn:function(){return[t._t("default",null,{goodIds:t.category.goodIds})]},proxy:!0}],null,!0)})},p=[],f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card"},[n("div",{staticClass:"card-title",style:t.styles},[t._t("title")],2),n("div",{staticClass:"card-content"},[t._t("content")],2)])},v=[],m={props:{color:{type:String,default:"#f8754b"}},computed:{styles:function(){return{backgroundColor:this.color}}}},b=m,g=(n("bab7"),n("2877")),h=Object(g["a"])(b,f,v,!1,null,null,null),y=h.exports,k={components:{Card:y},props:{category:{type:Object,required:!0}}},j=k,O=(n("be88"),Object(g["a"])(j,d,p,!1,null,null,null)),_=O.exports,w=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"goods"},[n("div",{staticClass:"goods-title"},[t._v(t._s(t.goods.name)+" ("+t._s(t.goods.limit)+")")]),n("div",{staticClass:"goods-price"},[n("Price",{attrs:{price:t.goods.price}})],1),n("button",{staticClass:"goods-button",on:{click:function(e){return t.onBasket(t.goods)}}},[n("img",{attrs:{src:t.$options.icons.basket}})])])},x=[],M=n("2110"),C=n.n(M),R=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",{class:t.className},[t._v(t._s(t.price))])},B=[],G=(n("a9e3"),{props:{price:{type:Number,required:!0}},data:function(){return{oldVal:null}},watch:{price:function(t,e){this.oldVal=e}},computed:{className:function(){if(null!==this.oldVal)return this.oldVal>this.price?"green":this.oldVal<this.price?"red":""}}}),P=G,q=(n("2df3"),Object(g["a"])(P,R,B,!1,null,"ef712bb8",null)),N=q.exports,E={components:{Price:N},icons:{basket:C.a},props:{goods:{type:Object,required:!0},onBasket:{type:Function,required:!0}}},$=E,S=(n("ad3b"),Object(g["a"])($,w,x,!1,null,null,null)),I=S.exports,T={components:{Category:_,Goods:I},props:{categoriesMap:{type:Object,required:!0},goodsMap:{type:Object,required:!0},onBasket:{type:Function,required:!0}}},F=T,V=(n("7cd2"),Object(g["a"])(F,u,l,!1,null,null,null)),D=V.exports,J=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Card",{staticClass:"basket",attrs:{color:"#f3501b"},scopedSlots:t._u([{key:"title",fn:function(){return[t._v("Корзина")]},proxy:!0},{key:"content",fn:function(){return[t.isEmpty?n("div",[t._v("Корзина пуста")]):[n("Row",{scopedSlots:t._u([{key:"name",fn:function(){return[t._v("Название")]},proxy:!0},{key:"count",fn:function(){return[t._v("Количество")]},proxy:!0},{key:"price",fn:function(){return[t._v("Цена за шт.")]},proxy:!0}])}),t._l(t.items,(function(e,r){return n("Item",{key:r,attrs:{goods:t.goodsMap[r],count:e,onBasket:t.onBasket}})})),n("div",{staticClass:"basket-total"},[t._v(" Общая стоимость: "),n("span",[t._v(t._s(t.total))])])]]},proxy:!0}])})},W=[],z=(n("13d5"),n("b64b"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("Row",{scopedSlots:t._u([{key:"name",fn:function(){return[t._v(t._s(t.goods.name))]},proxy:!0},{key:"count",fn:function(){return[n("div",[n("input",{ref:"count",domProps:{value:t.count},on:{input:t.onInput,change:t.onChange}}),t._v(" шт. "),n("div",{staticClass:"max"},[t._v("максимум: "+t._s(t.goods.limit))])])]},proxy:!0},{key:"price",fn:function(){return[n("Price",{attrs:{price:t.goods.price}}),t._v("/ шт. ")]},proxy:!0},{key:"actions",fn:function(){return[n("button",{staticClass:"delete",on:{click:t.deleteFromBasket}},[t._v("Удалить")])]},proxy:!0}])})}),A=[],H=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"row"},[n("div",{staticClass:"row-name"},[t._t("name")],2),n("div",{staticClass:"row-count"},[t._t("count")],2),n("div",{staticClass:"row-price"},[t._t("price")],2),n("div",{staticClass:"row-actions"},[t._t("actions")],2)])},K=[],L={},Q=L,U=(n("1573"),Object(g["a"])(Q,H,K,!1,null,null,null)),X=U.exports,Y={components:{Row:X,Price:N},props:{goods:{type:Object,required:!0},count:{type:Number,required:!0},onBasket:{type:Function,required:!0}},data:function(){return{error:!1}},methods:{deleteFromBasket:function(){this.onBasket({id:this.goods.id,count:0})},onInput:function(t){var e=t.target.value;/[^\d]/.test(e)&&(t.preventDefault(),this.$refs.count.value=this.count)},onChange:function(t){var e=t.target.value;this.$refs.count.value=+e,this.onBasket({id:this.goods.id,count:+e})}}},Z=Y,tt=(n("68bc"),Object(g["a"])(Z,z,A,!1,null,null,null)),et=tt.exports,nt=function(t){return Math.ceil(100*t)/100},rt=function(t,e){return Math.random()*(e-t)+t},ot=n("13ea"),at=n.n(ot),st={components:{Card:y,Item:et,Row:X},props:{items:{type:Object,required:!0},goodsMap:{type:Object,required:!0},onBasket:{type:Function,required:!0}},computed:{isEmpty:function(){return at()(this.items)},total:function(){var t=this;return nt(Object.keys(this.items).reduce((function(e,n){return e+t.items[n]*t.goodsMap[n].price}),0))}}},ct=st,it=(n("1e36"),Object(g["a"])(ct,J,W,!1,null,null,null)),ut=it.exports,lt={components:{Catalog:D,Basket:ut},data:function(){return{loading:!1}},created:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t.loading=!0,e.next=4,t.init();case 4:e.next=9;break;case 6:e.prev=6,e.t0=e["catch"](0),console.error(e.t0);case 9:return e.prev=9,t.loading=!1,e.finish(9);case 12:case"end":return e.stop()}}),e,null,[[0,6,9,12]])})))()},beforeDestroy:function(){this.timout&&clearTimeout(this.timout)},methods:Object(s["a"])({init:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.loadGoods(),t.loadNames(),t.loadRate()]);case 2:t.interval();case 3:case"end":return e.stop()}}),e)})))()},interval:function(){var t=this;this.timout=setTimeout(Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.all([t.loadGoods(),t.loadRate()]);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e["catch"](0),console.error(e.t0);case 8:return e.prev=8,t.interval(),e.finish(8);case 11:case"end":return e.stop()}}),e,null,[[0,5,8,11]])}))),15e3)}},Object(i["b"])({loadGoods:"loadGoods",loadNames:"loadNames",loadRate:"loadRate",updateBasket:"updateBasket"})),computed:Object(s["a"])(Object(s["a"])({},Object(i["c"])(["categoriesMap","goodsMap"])),Object(i["d"])(["basket"]))},dt=lt,pt=(n("034f"),Object(g["a"])(dt,o,a,!1,null,null,null)),ft=pt.exports,vt=(n("99af"),n("2909")),mt=n("ade3"),bt=n("3eea"),gt=n.n(bt),ht=n("d4ec"),yt=n("bee2"),kt=n("f9c7"),jt=(n("10d1"),n("5364")),Ot=n("9bd1"),_t=new WeakMap,wt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=e.headers;Object(ht["a"])(this,t),_t.set(this,{writable:!0,value:null}),Object(Ot["a"])(this,_t,{headers:n})}return Object(yt["a"])(t,[{key:"request",value:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e,n){var r,o,a,c,i,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=n.method,o=n.body,a=n.headers,c=Object(jt["a"])(this,_t),i=c.headers,t.next=4,fetch(e,{method:r,body:o,headers:Object(s["a"])(Object(s["a"])({},i),a)});case 4:if(u=t.sent,u.ok){t.next=7;break}throw Error(u.statusText);case 7:return t.abrupt("return",u.json());case 8:case"end":return t.stop()}}),t,this)})));function e(e,n){return t.apply(this,arguments)}return e}()},{key:"get",value:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",this.request(e,{method:"GET"}));case 1:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()}]),t}(),xt=wt,Mt=function(){function t(){Object(ht["a"])(this,t)}return Object(yt["a"])(t,null,[{key:"getGoods",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(kt["a"])(this,t,Ct).get("/data.json"));case 1:case"end":return e.stop()}}),e,this)})));function n(){return e.apply(this,arguments)}return n}()},{key:"getNames",value:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",Object(kt["a"])(this,t,Ct).get("/names.json"));case 1:case"end":return e.stop()}}),e,this)})));function n(){return e.apply(this,arguments)}return n}()}]),t}(),Ct={writable:!0,value:new xt},Rt=Mt;r["a"].use(i["a"]);var Bt=new i["a"].Store({state:{rate:0,goods:[],namesMap:{},basket:{}},mutations:{setRate:function(t,e){t.rate=e},setGoods:function(t,e){t.goods=e},setNamesMap:function(t,e){t.namesMap=e},setBasket:function(t,e){var n=e.id,r=e.count,o=void 0===r?1:r,a=t.basket;t.basket=o<=0?gt()(a,[n]):Object(s["a"])(Object(s["a"])({},a),{},Object(mt["a"])({},n,o))},fromBasket:function(t,e){t.namesMap=e}},actions:{init:function(t){var e=t.dispatch;return Promise.all([e("loadGoods"),e("loadNames")])},loadGoods:function(t){return Object(c["a"])(regeneratorRuntime.mark((function e(){var n,r,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.commit,e.next=3,Rt.getGoods();case 3:r=e.sent,o=r.Value.Goods,n("setGoods",o);case 6:case"end":return e.stop()}}),e)})))()},loadNames:function(t){return Object(c["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.commit,e.t0=n,e.next=4,Rt.getNames();case 4:e.t1=e.sent,(0,e.t0)("setNamesMap",e.t1);case 6:case"end":return e.stop()}}),e)})))()},updateBasket:function(t,e){var n,r=t.commit,o=t.getters,a=e.id,s=e.count,c=void 0===s?1:s,i=null===(n=o["goodsMap"][a])||void 0===n?void 0:n.limit;r("setBasket",{id:a,count:c>i?i:c})},loadRate:function(t){return Object(c["a"])(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=t.commit,n("setRate",nt(rt(20,80)));case 2:case"end":return e.stop()}}),e)})))()}},getters:{categoriesMap:function(t){var e=t.goods,n=t.namesMap;return e.reduce((function(t,e){var r,o,a=e.G,c=e.T;return Object(s["a"])(Object(s["a"])({},t),{},Object(mt["a"])({},a,{id:a,name:null===(r=n[a])||void 0===r?void 0:r.G,goodIds:[].concat(Object(vt["a"])((null===(o=t[a])||void 0===o?void 0:o.goodIds)||[]),[c])}))}),{})},goodsMap:function(t){var e=t.goods,n=t.namesMap,r=t.rate;return e.reduce((function(t,e){var o,a,c,i=e.T,u=e.P,l=e.C,d=e.G;return Object(s["a"])(Object(s["a"])({},t),{},Object(mt["a"])({},i,{id:i,name:(null===(o=n[d])||void 0===o?void 0:o.B)&&(null===(a=n[d])||void 0===a||null===(c=a.B[i])||void 0===c?void 0:c.N),limit:u,price:nt(l*r)}))}),{})}}});r["a"].config.productionTip=!1,new r["a"]({store:Bt,render:function(t){return t(ft)}}).$mount("#app")},"5e3a":function(t,e,n){},"68bc":function(t,e,n){"use strict";var r=n("c0bd"),o=n.n(r);o.a},7211:function(t,e,n){},"7cd2":function(t,e,n){"use strict";var r=n("7211"),o=n.n(r);o.a},"85ec":function(t,e,n){},a23b:function(t,e,n){},ad3b:function(t,e,n){"use strict";var r=n("4a51"),o=n.n(r);o.a},bab7:function(t,e,n){"use strict";var r=n("5e3a"),o=n.n(r);o.a},be88:function(t,e,n){"use strict";var r=n("a23b"),o=n.n(r);o.a},c0bd:function(t,e,n){},e29d:function(t,e,n){}});
//# sourceMappingURL=app.8e6bfd45.js.map